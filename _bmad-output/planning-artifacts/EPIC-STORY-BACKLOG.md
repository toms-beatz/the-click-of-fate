# üìö EPIC & STORY BACKLOG

## Click of Fate - Development Documentation

---

> **Owner**: Combat Architect Agent # üèîÔ∏è EPIC 1: Core Combat System

> **Sprint**: 1-2> **Status**: ‚úÖ COMPLETED

## Description

Impl√©menter le syst√®me de combat auto-battler avec h√©ros, ennemis, et interactions en temps r√©el.

---

| Field | Value |### üìñ STORY 1.1: Base Entity System

| **ID** | COF-001 ||-------|-------|

| **Priority** | P0 - Critical || **Type** | Feature |

| **Agent** | Backend Developer || **Story Points** | 8 |

| **Status** | ‚úÖ Done |

> En tant que d√©veloppeur, je veux un syst√®me d'entit√©s de base pour que les h√©ros et ennemis partagent une logique commune.**User Story**:

**Acceptance Criteria**:

- [x] Signal `hp_changed(current, max)` pour UI- [x] Signal `died` √©mis quand HP <= 0- [x] `EntityStats` resource pour configuration- [x] `BaseEntity` class avec HP, stats, et signaux

- [x] M√©thodes `take_damage()` et `heal()`

**Technical Constraints Learned**:

````gdscript




















































































































































































































































































































































































































































































































































| COF-054 | Achievement System | P3 || COF-053 | Shop System | P3 || COF-052 | Enemy Variety (behaviors) | P3 || COF-051 | Hero Skill Animations | P2 || COF-050 | Sound Effects & Music | P2 ||-------|-------------|----------|| Story | Description | Priority |## Next Sprint Candidates---4. Signaux directs pour √©v√©nements critiques (mort, victoire)3. Mini/Maxi pour tailles adaptatives2. Positions en % pour mobile1. Utiliser `Vector2` explicite pour viewport size### üü¢ Best Practices Established4. State machine shouldn't handle per-action blocking3. Signal connections must be managed carefully2. Mobile responsive requires explicit sizing1. Godot 4.x type inference limitations### üü° Technical Constraints4. **Power non synchronis√©** ‚Üí Calcul diff√©rent entre level_select et combat3. **Defeat ne se d√©clenchait pas** ‚Üí Appelait `state_machine.transition_to()` au lieu de `_on_defeat()` directement2. **Boss HP bar √† 0** ‚Üí Utilisait `current_hp` au lieu de `max_hp`1. **Overload bloquait TOUT** ‚Üí Maintenant par action### üî¥ Critical Bugs Fixed## Key Learnings| **Game Designer** | Balance & Mechanics | Epic 2 & 3 supervision || **UI/UX Developer** | Interface & Polish | COF-004, COF-020, COF-030, COF-031, COF-032, COF-033, COF-040 || **Backend Developer** | Core Logic | COF-010, COF-011, COF-021, COF-022 || **Combat Architect** | System Design | COF-001, COF-002, COF-003 ||-------|------|-------------------|| Agent | Role | Stories Completed |## Agents & Responsibilities# üìä SUMMARY---- `scenes/game_combat_scene.gd`- `scenes/ui/options_menu.tscn`- `scenes/ui/level_select.tscn`- `scenes/ui/main_menu.tscn`**Files Modified**:- [x] Game Over en anglais- [x] Combat UI en anglais- [x] Options en anglais- [x] Level Select en anglais- [x] Main Menu en anglais**Acceptance Criteria**:> En tant que joueur international, je veux une interface en anglais.**User Story**:| **Status** | ‚úÖ Done || **Agent** | UI/UX Developer || **Story Points** | 3 || **Priority** | P1 - High || **Type** | Feature || **ID** | COF-040 ||-------|-------|| Field | Value |### üìñ STORY 5.1: English UI---> **Sprint**: 5> **Status**: ‚úÖ COMPLETED  > **Owner**: UI/UX Developer Agent  # üèîÔ∏è EPIC 5: Localization---- `scenes/game_combat_scene.gd` (tous les `_show_floating_text()`)**Files Modified**:- [x] VICTORY/WAVE ‚Üí centre de l'√©cran- [x] D√©g√¢ts inflig√©s ‚Üí sur l'ennemi touch√©- [x] D√©g√¢ts re√ßus ‚Üí sur le h√©ros- [x] ATTACK/CRIT ‚Üí sur les ennemis- [x] HEAL/SHIELD ‚Üí sur le h√©ros**Acceptance Criteria**:> En tant que joueur, je veux que les textes flottants apparaissent sur la bonne entit√©.**User Story**:| **Status** | ‚úÖ Done || **Agent** | UI/UX Developer || **Story Points** | 3 || **Priority** | P2 - Medium || **Type** | Enhancement || **ID** | COF-033 ||-------|-------|| Field | Value |### üìñ STORY 4.4: Visual Feedback Positions---- `scenes/game_combat_scene.gd` (toutes les positions/tailles)- `project.godot`**Files Modified**:```var sprite_width: int = mini(150, int(viewport_size.x * 0.20))# Tailles adaptativeshero_container.position = Vector2(viewport_size.x * 0.12, viewport_size.y * 0.35)var viewport_size: Vector2 = get_viewport().get_visible_rect().size# Dans le codewindow/stretch/aspect = "keep_height"  # PAS "expand"!window/stretch/mode = "canvas_items"# project.godot```gdscript**Technical Constraints Learned**:- [x] Safe area pour encoches- [x] Tailles max avec `mini()`- [x] Positions en % du viewport- [x] Fonctionne sur 16:9, 18:9, 19.5:9, 20:9**Acceptance Criteria**:> En tant que joueur mobile, je veux que l'UI s'adapte √† mon √©cran.**User Story**:| **Status** | ‚úÖ Done || **Agent** | UI/UX Developer || **Story Points** | 8 || **Priority** | P1 - High || **Type** | Feature || **ID** | COF-032 ||-------|-------|| Field | Value |### üìñ STORY 4.3: Responsive UI---- `scenes/game_combat_scene.gd` (`ENDING_CINEMATIC`, `_show_ending_cinematic()`)**Files Modified**:- [x] Retour au menu apr√®s- [x] "TO BE CONTINUED..." en dor√©- [x] Slides de conclusion**Acceptance Criteria**:> En tant que joueur, apr√®s avoir vaincu Dr. Mortis, je veux une cin√©matique de fin √©pique.**User Story**:| **Status** | ‚úÖ Done || **Agent** | UI/UX Developer || **Story Points** | 3 || **Priority** | P2 - Medium || **Type** | Feature || **ID** | COF-031 ||-------|-------|| Field | Value |### üìñ STORY 4.2: Ending Cinematic---- `scenes/game_combat_scene.gd` (`PLANET_CINEMATICS`, `_show_cinematic()`)**Files Modified**:- [x] Indicateur de slide (1/3, 2/3, 3/3)- [x] Bouton "TAP TO CONTINUE"- [x] Effet machine √† √©crire (typewriter)- [x] Slides avec emoji + texte**Acceptance Criteria**:> En tant que joueur, je veux une cin√©matique d'intro pour chaque plan√®te pour l'immersion.**User Story**:| **Status** | ‚úÖ Done || **Agent** | UI/UX Developer || **Story Points** | 5 || **Priority** | P2 - Medium || **Type** | Feature || **ID** | COF-030 ||-------|-------|| Field | Value |### üìñ STORY 4.1: Intro Cinematics---> **Sprint**: 4-5> **Status**: ‚úÖ COMPLETED  > **Owner**: UI/UX Developer Agent  # üèîÔ∏è EPIC 4: Cinematics & Polish---- `scripts/autoload/save_manager.gd`**Files Modified**:- [x] Persistence entre sessions- [x] Session tracking pour RETRY (restaure les coins)- [x] Sauvegarde de `currency` (StarCoins)- [x] Sauvegarde de `highest_planet_completed`**Acceptance Criteria**:> En tant que joueur, je veux que ma progression soit sauvegard√©e pour reprendre plus tard.**User Story**:| **Status** | ‚úÖ Done || **Agent** | Backend Developer || **Story Points** | 5 || **Priority** | P1 - High || **Type** | Feature || **ID** | COF-022 ||-------|-------|| Field | Value |### üìñ STORY 3.3: Save System---- `scenes/game_combat_scene.gd` (fonctions `_spawn_boss()`, `_create_boss_visual()`)**Files Modified**:```hp_bar.value = boss.base_stats.max_hp  # Utiliser max_hphp_bar.max_value = boss.base_stats.max_hp# APR√àS:hp_bar.value = boss.current_hp  # BUG: current_hp = 0 √† la cr√©ation!# AVANT:# BUG FIX: La barre HP du boss utilisait current_hp au lieu de max_hp```gdscript**Technical Constraints Learned**:```}    3: {"name": "DR. MORTIS", "emoji": "üíÄ", "hp": 1500, ...},  # FINAL BOSS    2: {"name": "Mars Warlord", "emoji": "‚öîÔ∏è", "hp": 700, ...},    1: {"name": "Venus Queen", "emoji": "üëë", "hp": 550, ...},    0: {"name": "Mercury Guardian", "emoji": "üî•", "hp": 400, ...},const PLANET_BOSSES := {```gdscript**Boss Data**:- [x] Dr. Mortis sur Earth = boss final √©pique- [x] Visuel distinctif (emoji + nom + barre HP)- [x] HP et stats sp√©cifiques par boss- [x] Boss unique par plan√®te- [x] Boss spawn apr√®s wave 5**Acceptance Criteria**:> En tant que joueur, je veux affronter un boss apr√®s 5 vagues pour avoir un challenge final.**User Story**:| **Status** | ‚úÖ Done || **Agent** | Backend Developer || **Story Points** | 13 || **Priority** | P1 - High || **Type** | Feature || **ID** | COF-021 ||-------|-------|| Field | Value |### üìñ STORY 3.2: Boss System---- `scenes/ui/level_select.tscn`- `scripts/ui/level_select.gd`**Files Modified**:```}    3: {"power": 400, "hp_mult": 2.5, "atk_mult": 2.0},   # Earth compl√©t√©    2: {"power": 280, "hp_mult": 2.0, "atk_mult": 1.7},   # Mars compl√©t√©    1: {"power": 200, "hp_mult": 1.6, "atk_mult": 1.4},   # Venus compl√©t√©    0: {"power": 150, "hp_mult": 1.3, "atk_mult": 1.2},   # Mercury compl√©t√©    -1: {"power": 100, "hp_mult": 1.0, "atk_mult": 1.0},  # Nouveau joueurconst HERO_POWER_PER_PLANET := {# La puissance du joueur doit √™tre calcul√©e de la m√™me fa√ßon partout```gdscript**Technical Constraints Learned**:- [x] Bouton PLAY / REPLAY selon compl√©tion- [x] Affichage de la puissance recommand√©e- [x] Affichage de la difficult√© (√©toiles)- [x] Plan√®tes verrouill√©es jusqu'√† compl√©tion de la pr√©c√©dente- [x] Carrousel navigable (fl√®ches + swipe)- [x] 4 plan√®tes: Mercury, Venus, Mars, Earth**Acceptance Criteria**:> En tant que joueur, je veux s√©lectionner une plan√®te pour choisir mon niveau de difficult√©.**User Story**:| **Status** | ‚úÖ Done || **Agent** | UI/UX Developer || **Story Points** | 8 || **Priority** | P1 - High || **Type** | Feature || **ID** | COF-020 ||-------|-------|| Field | Value |### üìñ STORY 3.1: Planet Selection---Syst√®me de progression lin√©aire √† travers 4 plan√®tes avec scaling de difficult√© et boss.## Description> **Sprint**: 3-4> **Status**: ‚úÖ COMPLETED  > **Owner**: Game Designer Agent  # üèîÔ∏è EPIC 3: Progression System---- `scenes/game_combat_scene.gd` (v√©rification par action)- `scripts/core/combat/pressure_gauge.gd` (ajout `is_action_blocked()`)- `scripts/core/combat/combat_state_machine.gd` (comment√© connexions)**Files Modified**:```# Chaque action v√©rifie: pressure_gauge.is_action_blocked(action)# L'overload est g√©r√© localement dans game_combat_scene._on_player_action()# APR√àS: Comment√© ces connexions# ‚Üí Bloquait TOUT le combat# pressure_gauge.punishment_started.connect(_enter_punished_state)# AVANT: Dans combat_state_machine.gd```gdscript**Bug Fixed**:- [x] Le combat continue normalement- [x] UI refl√®te visuellement l'action bloqu√©e (gris√©e)- [x] Overload Attack ‚Üí seulement Attack bloqu√©- [x] Overload Dodge ‚Üí seulement Dodge bloqu√©- [x] Overload Heal ‚Üí seulement Heal bloqu√©**Acceptance Criteria**:> En tant que joueur, quand je surcharge le Heal, je veux pouvoir encore utiliser Dodge et Attack.**User Story**:| **Status** | ‚úÖ Done || **Agent** | Backend Developer || **Story Points** | 5 || **Priority** | P0 - Critical || **Type** | Bug Fix / Refactor || **ID** | COF-011 ||-------|-------|| Field | Value |### üìñ STORY 2.2: Per-Action Overload---- `scripts/core/combat/pressure_gauge.gd`**Files Modified**:```}    &"attack": 0.0    &"dodge": 0.0,    &"heal": 0.0,  # Timer restant (0 = pas bloqu√©)var blocked_actions: Dictionary = {# L'overload ne bloque QUE l'action concern√©e, pas toutes}    &"attack": 4.0  # Attack interm√©diaire    &"dodge": 3.0,  # Dodge moyen    &"heal": 5.0,   # Le heal est pr√©cieux, punition longueconst PUNISHMENT_DURATIONS := {# Dur√©es d'overload diff√©rentes par type d'action```gdscript**Technical Constraints Learned**:- [x] Dur√©e de blocage variable par action- [x] Overload √† 100% ‚Üí action bloqu√©e X secondes- [x] Diminue naturellement avec le temps- [x] Augmente √† chaque action- [x] 3 jauges s√©par√©es (heal, dodge, attack)**Acceptance Criteria**:> En tant que joueur, je veux voir une jauge de pression par action pour savoir quand je risque un overload.**User Story**:| **Status** | ‚úÖ Done || **Agent** | Backend Developer || **Story Points** | 8 || **Priority** | P0 - Critical || **Type** | Feature || **ID** | COF-010 ||-------|-------|| Field | Value |### üìñ STORY 2.1: Pressure Gauge Base---Syst√®me de jauge de pression qui punit le spam d'actions avec un overload temporaire PAR ACTION.## Description> **Sprint**: 2-3> **Status**: ‚úÖ COMPLETED  > **Owner**: Game Designer Agent  # üèîÔ∏è EPIC 2: Pressure System---- `scripts/ui/click_zone_button.gd`**Files Modified**:```}    &"attack": false    &"dodge": false,    &"heal": false,var blocked_zones: Dictionary = {# Les zones doivent pouvoir √™tre gris√©es individuellementsignal zone_clicked(action: StringName)# Utiliser StringName pour les actions (performance)```gdscript**Technical Constraints Learned**:- [x] Zones individuellement d√©sactivables- [x] Signal `zone_clicked(action: StringName)`- [x] Feedback visuel au clic- [x] Couleurs distinctives (bleu / violet / rouge)- [x] Zone divis√©e: Heal (gauche) / Dodge (centre) / Attack (droite)**Acceptance Criteria**:> En tant que joueur, je veux une zone de clic divis√©e en 3 sections pour choisir mon action rapidement.**User Story**:| **Status** | ‚úÖ Done || **Agent** | UI/UX Developer || **Story Points** | 8 || **Priority** | P0 - Critical || **Type** | Feature || **ID** | COF-004 ||-------|-------|| Field | Value |### üìñ STORY 1.4: Tripartite Click Zone---- `scripts/core/combat/combat_state_machine.gd`**Files Modified**:```# Chaque action v√©rifie individuellement si elle est bloqu√©e# APR√àS (correct):# state_machine.enter_state(State.PUNISHED)  # Bloquait TOUT# AVANT (bug):# Le state machine reste en COMBAT m√™me pendant un overload# L'overload est g√©r√© PAR ACTION dans pressure_gauge# NE PAS utiliser l'√©tat PUNISHED pour l'overload```gdscript**Technical Constraints Learned**:- [x] M√©thode `can_player_act()` pour bloquer les actions- [x] Signal `state_changed(old, new)`- [x] Transitions valid√©es- [x] √âtats: IDLE, COMBAT, BOSS_PHASE, VICTORY, DEFEAT**Acceptance Criteria**:> En tant que syst√®me, je veux g√©rer les √©tats du combat pour coordonner les phases de jeu.**User Story**:| **Status** | ‚úÖ Done || **Agent** | Backend Developer || **Story Points** | 5 || **Priority** | P0 - Critical || **Type** | Feature || **ID** | COF-003 ||-------|-------|| Field | Value |### üìñ STORY 1.3: Combat State Machine---- `scripts/core/combat/combat_manager.gd`**Files Modified**:```    add_child(attack_timer)  # IMPORTANT: ajouter comme enfant    attack_timer.wait_time = 1.0 / hero.base_stats.attack_speed    attack_timer = Timer.new()func _ready():var attack_timer: Timer# Les timers doivent √™tre cr√©√©s dans _ready, pas dans le constructeur```gdscript**Technical Constraints Learned**:- [x] Signaux pour toutes les actions (attacked, damaged, healed, etc.)- [x] Dodge chance fonctionnel- [x] Calcul de d√©g√¢ts avec crit chance- [x] Auto-attaque des ennemis- [x] Auto-attaque du h√©ros bas√©e sur `attack_speed`**Acceptance Criteria**:> En tant que joueur, je veux que le combat se d√©roule automatiquement pour que je puisse me concentrer sur les actions strat√©giques.**User Story**:| **Status** | ‚úÖ Done || **Agent** | Backend Developer || **Story Points** | 13 || **Priority** | P0 - Critical || **Type** | Feature || **ID** | COF-002 ||-------|-------|| Field | Value |### üìñ STORY 1.2: Combat Manager---- `scripts/entities/base_enemy.gd`- `scripts/entities/base_hero.gd`- `scripts/entities/entity_stats.gd`- `scripts/entities/base_entity.gd`**Files Modified**:```        # NE PAS queue_free() ici - laisser le parent g√©rer        died.emit()  # D'abord le signal    if current_hp <= 0:func _check_death():signal died# Le signal died doit √™tre √©mis AVANT queue_free()
````
